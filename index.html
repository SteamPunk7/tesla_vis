
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trippy Visualizer with Controls</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      width: 100%;
      height: 100%;
    }
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0;
      width: 100vw;
      height: 100vh;
    }
    .photo {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 75vw;
      max-height: 75vh;
      opacity: 0;
      transition: opacity 2s ease-in-out;
      z-index: 1;
    }
    .visible {
      opacity: 1 !important;
    }
    #controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 2;
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border-radius: 8px;
    }
    button {
      font-size: 16px;
      margin: 0 5px;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <!-- Image Elements -->
  <img class="photo" id="img1" src="img1.jpg">
  <img class="photo" id="img2" src="img2.jpg">
  <img class="photo" id="img3" src="img3.jpg">
  <img class="photo" id="img4" src="img4.jpg">
  <img class="photo" id="img5" src="img5.jpg">
  <img class="photo" id="img6" src="img6.jpg">
  <img class="photo" id="img7" src="img7.jpg">
  <img class="photo" id="img8" src="img8.jpg">
  <img class="photo" id="img9" src="img9.jpg">
  <img class="photo" id="img10" src="img10.jpg">
  <img class="photo" id="img11" src="img11.jpg">
  <img class="photo" id="img12" src="img12.jpg">
  <img class="photo" id="img13" src="img13.jpg">
  <img class="photo" id="img14" src="img14.jpg">
  <img class="photo" id="img15" src="img15.jpg">
  <img class="photo" id="img16" src="img16.jpg">
  <img class="photo" id="img17" src="img17.jpg">
  <img class="photo" id="img18" src="sunset.jpg">

  <!-- Control Buttons -->
  <div id="controls">
    <button onclick="togglePlay()"><span id="playLabel">Pause</span></button>
    <button onclick="rewind()">⏮ Rewind</button>
    <button onclick="skip()">⏭ Skip</button>
    <button onclick="toggleFullscreen()">⛶ Fullscreen</button>
  </div>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  let t = 0;
  let animating = true;

  function drawTunnel() {
    if (!animating) return;
    const w = canvas.width;
    const h = canvas.height;
    const imageData = ctx.createImageData(w, h);
    const data = imageData.data;

    for (let y = 0; y < h; y++) {
      for (let x = 0; x < w; x++) {
        let dx = x - w / 2;
        let dy = y - h / 2;
        let dist = Math.sqrt(dx * dx + dy * dy);
        let angle = Math.atan2(dy, dx);
        let swirl = Math.sin(dist * 0.05 - t) + Math.cos(angle * 6 + t * 0.3);
        let r = Math.floor(90 * (Math.sin(swirl + t) + 1));
        let g = Math.floor(90 * (Math.sin(swirl + t + 2) + 1));
        let b = Math.floor(90 * (Math.sin(swirl + t + 4) + 1));
        const index = (x + y * w) * 4;
        data[index] = r;
        data[index + 1] = g;
        data[index + 2] = b;
        data[index + 3] = 255;
      }
    }

    ctx.putImageData(imageData, 0, 0);
    t += 0.03;
    requestAnimationFrame(drawTunnel);
  }

  drawTunnel();

  function togglePlay() {
    animating = !animating;
    document.getElementById("playLabel").innerText = animating ? "Pause" : "Play";
    if (animating) {
      drawTunnel();
      cycleImages();
    }
  }

  function toggleFullscreen() {
    const elem = document.documentElement;
    if (!document.fullscreenElement) {
      elem.requestFullscreen().catch(err => alert(`Error: ${err.message}`));
    } else {
      document.exitFullscreen();
    }
  }

  const images = [...Array(17).keys()].map(i => document.getElementById(`img${i + 1}`));
  images.sort(() => Math.random() - 0.5);
  let sunset = document.getElementById("img18");
  let current = 0;
  let fadeDuration = 2000;
  let visibleDuration = 20000;
  let cycleTimer;

  function cycleImages() {
    if (!animating || current >= images.length) return;
    let img = images[current];
    img.classList.add("visible");
    cycleTimer = setTimeout(() => {
      img.classList.remove("visible");
      current++;
      cycleImages();
    }, visibleDuration);
  }

  function rewind() {
    clearTimeout(cycleTimer);
    images.forEach(img => img.classList.remove("visible"));
    sunset.classList.remove("visible");
    current = 0;
    cycleImages();
  }

  function skip() {
    if (current < images.length - 1) {
      images[current].classList.remove("visible");
      current++;
      cycleImages();
    } else {
      sunset.classList.add("visible");
    }
  }

  cycleImages();
</script>
</body>
</html>
